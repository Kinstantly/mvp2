- @page_title_prefix = @profile.display_name_or_company
- @body_class ||= 'interior edit'
- @using_photo_editor = true
:javascript
	my_vars.edit_profile = my_vars.edit_profile || {};
	my_vars.edit_profile.max_lengths = #{Profile::MAX_LENGTHS.to_json};
	my_vars.edit_profile.text_area_value_length = function(el) { return el.val().replace(/\n/g, '\r\n').length; };
	my_vars.edit_location = my_vars.edit_location || {};
	my_vars.edit_location.max_lengths = #{Location::MAX_LENGTHS.to_json};
- if can?(:manage, Profile)
	.editor_buttons
		- unless @profile.owned_by? current_user
			= profile_link @profile
		= full_profile_link @profile
		= edit_full_profile_link @profile
		- if !@profile.claimed?
			= new_invitation_profile_link @profile
		= admin_profiles_link
		= admin_link
		- if can?(:destroy, @profile)
			= render partial: 'destroy', locals: {profile: @profile}
- cache ['edit_profile', @profile] do
	%article#content
		%header#content-header.clearfix
			-# = image_tag 'profile-photo.jpg', alt: "#{@profile.display_name_or_company}", width: '168', height: '168', border: '0', class: 'profile-photo', itemprop: 'image'
			-#.profile-photo-placeholder
			-#	= t 'views.profile.view.profile_photo_placeholder'
			#profile-photo.photo-wrapper-large.clickable
				= image_tag @profile.profile_photo.url(:original), alt: "#{@profile.display_name_or_company}", itemprop: 'image', onerror: "this.src = '#{image_path(Profile::DEFAULT_PHOTO_PATH)}'"
				#profile_photo.formlet
					= render partial: 'profile_photo'
			.profile{itemscope: "", itemtype: "http://schema.org/Person"}
				#display_name.formlet
					= render partial: 'formlet', locals: {formlet: 'display_name'}
				#job.formlet
					= render partial: 'formlet', locals: {formlet: 'job'}
				#locations.formlet
					= render partial: 'formlet', locals: {formlet: 'locations'}
				#internet.formlet
					= render partial: 'formlet', locals: {formlet: 'internet'}
			#rate_review
				= render partial: 'profiles/rating_score', locals: {profile: @profile}
				.appointment
					%a{href: "#"}= t 'views.profile.view.make_an_appointment'
		%section#details.clearfix
			.interior
				.summary-text
					#summary.formlet.editable
						= render partial: 'formlet', locals: {formlet: 'summary'}
					#certifications.formlet.editable
						= render partial: 'formlet', locals: {formlet: 'certifications'}
					#education.formlet.editable
						= render partial: 'formlet', locals: {formlet: 'education'}
					#year_started.formlet.editable
						= render partial: 'formlet', locals: {formlet: 'year_started'}
				%table.info{border: "0", cellpadding: "0", cellspacing: "0"}
					%tr#services.formlet
						= render partial: 'formlet', locals: {formlet: 'services'}
					%tr#ages_stages.formlet
						= render partial: 'formlet', locals: {formlet: 'ages_stages'}
					%tr#hours.formlet
						= render partial: 'formlet', locals: {formlet: 'hours'}
					%tr#pricing.formlet
						= render partial: 'formlet', locals: {formlet: 'pricing'}
					%tr#insurance_accepted.formlet
						= render partial: 'formlet', locals: {formlet: 'insurance_accepted'}
					%tr#languages.formlet
						= render partial: 'formlet', locals: {formlet: 'languages'}
					%tr#availability_service_area.formlet
						= render partial: 'formlet', locals: {formlet: 'availability_service_area'}
	:coffeescript
		# Place the formlet the specified number of pixels below the top of the viewport (assume absolute positioning).
		my_vars.f.place_formlet = (formlet) ->
			$('.popover', formlet).css('top', $(window).scrollTop() + 20)
		# Clicking within a formlet element will activate it unless we clicked on a 'dont_popover' element.
		$('.formlet').click (e) ->
			unless $(this).hasClass('active') or $(e.target).hasClass('dont_popover')
				my_vars.f.place_formlet this
				$(this).addClass 'active'
