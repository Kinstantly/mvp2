= javascript_include_tag 'payment'
#content
	#customer_file.payments
		- customer_name = @customer_file.customer_name
		%h1= customer_name
		- if @customer_file.customer_has_authorized_payment?
			%div= t 'views.customer_file.view.authorized_amount', amount: display_currency_amount(@customer_file.authorized_amount)
			%div= link_to t('views.customer_file.view.reminder_prompt', user: customer_name), '#'
		- else
			%div= t 'views.customer_file.view.not_authorized_explanation'
			- if @customer_file.has_customer_account?
				%div= link_to t('views.customer_file.view.request_reauthorization_prompt', user: customer_name), '#'
			- else
				%div= t 'views.customer_file.view.customer_account_deleted_explanation'
		.buttons
			= link_to t('views.customer_file.view.cancel'), customer_files_path, class: 'default medium'
			- if @customer_file.customer_has_authorized_payment?
				= link_to t('views.customer_file.view.new_charge'), new_charge_customer_file_path(@customer_file), class: 'default medium'
		%h2= t 'views.customer_file.view.contact_information'
		%table.attributes
			%tr
				%th= t 'views.customer_file.view.email'
				%td= mail_to @customer_file.customer_email
		%h2= t 'views.customer_file.view.charge_history'
		%table.tablesorter#charge_history
			%thead
				%tr
					%th= t 'views.customer_file.view.charge_history_date'
					%th= t 'views.customer_file.view.charge_history_amount'
					%th= t 'views.customer_file.view.charge_history_description'
					%th
			%tbody
				- @customer_file.stripe_charges.each do |charge|
					%tr
						%td= display_transaction_date charge.created_at
						%td= display_currency_amount charge.amount_usd
						%td= charge.description
						%td= link_to t('views.customer_file.view.charge_details_button'), charge, class: 'button'

		-# .tablesorterPager#charge_history_pager
		-# 	%form
		-# 		= image_tag 'tablesorter/pager/first.png', class: 'first'
		-# 		= image_tag 'tablesorter/pager/prev.png', class: 'prev'
		-# 		%input.pagedisplay{type: 'text'}
		-# 		= image_tag 'tablesorter/pager/next.png', class: 'next'
		-# 		= image_tag 'tablesorter/pager/last.png', class: 'last'
		-# 		%select.pagesize
		-# 			%option{selected: 'selected', value: '10'} 10
		-# 			%option{value: '20'} 20
		-# 			%option{value: '30'} 30
		-# 			%option{value: '40'} 40

:coffeescript
	$ ->
		$('#charge_history').tablesorter({sortList: [[0,1]], headers: {3: {sorter: false}}})
-# .tablesorterPager({container: $("#charge_history_pager")})
